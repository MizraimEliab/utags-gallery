<mat-toolbar class="example-toolbar color-nav">
	<button  mat-icon-button (click)="isExpanded = !isExpanded"><mat-icon [ngStyle]="{'color':'white'}">menu</mat-icon></button>
	<h1 class="example-app-name txt-title">Publication Gallery</h1>
	<button mat-button (click)="logOut()" class="fixedbutton">
		<mat-icon [ngStyle]="{'color':'white'}" mat-list-icon>exit_to_app</mat-icon>
	</button>
</mat-toolbar>

<mat-sidenav-container class="example-container">
	<mat-sidenav #sidenav class="example-sidenav" mode="side" opened="true" (mouseenter)="mouseenter()" (mouseleave)="mouseleave()">
		<mat-nav-list>
			<mat-list-item class="parent">
				<span class="full-width" *ngIf="isExpanded || isShowing" (click)="home()">Home</span>
				<mat-icon mat-list-icon>home</mat-icon>
			</mat-list-item>
			<mat-list-item class="parent" (click)="profile()">
				<span class="full-width" *ngIf="isExpanded || isShowing">Profile</span>
				<mat-icon mat-list-icon>person_outline</mat-icon>
			</mat-list-item>
			<div *ngIf="usertype==1">
				<mat-list-item class="parent"   (click)="channel()">
					<span class="full-width" *ngIf="isExpanded || isShowing">My Channel</span>
					<mat-icon mat-list-icon>tv</mat-icon>
				</mat-list-item>
			</div>
			
			<mat-list-item class="parent" (click)="fav()">
				<span class="full-width" *ngIf="isExpanded || isShowing">Favorites</span>
				<mat-icon mat-list-icon>star</mat-icon>
			</mat-list-item>
			<mat-list-item (click)="showSubmenu = !showSubmenu" class="parent">
				<span class="full-width" *ngIf="isExpanded || isShowing">Tags</span>
				<mat-icon mat-list-icon>local_offer</mat-icon>
				<mat-icon class="menu-button" [ngClass]="{'rotated' : showSubmenu}" *ngIf="isExpanded || isShowing">expand_more</mat-icon>
			</mat-list-item>
			<div class="submenu" [ngClass]="{'expanded' : showSubmenu}" *ngIf="isShowing || isExpanded">
				<a mat-list-item data-bs-toggle="modal" data-bs-target="#exampleModal">Add Tag<mat-icon mat-list-icon>add</mat-icon></a>
				<div *ngFor="let item of arrTags">
					<a (click)="redirectToTag(item.tag_id)" mat-list-item>{{item.name | titlecase}}</a>
				</div>
			</div>
		</mat-nav-list>
	</mat-sidenav>
	<div class="example-sidenav-content">
        <div *ngIf = "showAddPost">
            <button mat-fab style="background-color: #32a852;"  class="text-center m-5"> 
                <mat-icon [ngStyle]="{'color':'black'}" mat-list-item data-bs-toggle="modal" data-bs-target="#exampleModal" mat-list-icon>add</mat-icon>
            </button>
        </div>
        
        <button type="button" class="btn btn-success m-5" data-bs-toggle="modal" data-bs-target="#exampleModalChannel" *ngIf="!channel">Create Channel</button>
        

        
        <h2 class="text-center mt-5">Channel Name: {{nameChannel}}</h2>
        <h2 class="text-center mt-5"> Description: {{descriptionChanne}}</h2>
        <h2 class="text-center mt-5"> Post Quantity : {{postChannel}}</h2>
        <hr>
        <h1 class="text-center mt-5">My Posts</h1>
        
        <!-- All posts -->

        <div *ngIf = "!showPosts" style="text-align: center;">
            <h2>There are no posts in the channel</h2>
        </div>
        
        <div *ngIf = "showPosts">
            <div class="card" style="width: 40rem; margin: auto; margin-bottom: 2%;" *ngFor="let item of arrPosts" >
                <img class="card-img-top" src="{{item.image_url}}" alt="Card image cap">
                <div class="card-body">
                    <a ><h1 class="card-title" style="text-align: center;" >{{item.title}}</h1></a>
                    <p class="card-text">{{item.content}}</p>
                </div>
            </div>
        </div>
            
	</div> 
    <div class="bajarFondo"></div>
</mat-sidenav-container>

<!-- Modal Post -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel">Add New Post</h2>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form (submit)="newPost()" name="formRecipe" #formRecipe="ngForm">
                    <div class="form-group form-outline mb-4">
                        <label for="exampleInputEmail1" class="form-label">Post title</label>
                        <input [(ngModel)]="post.title"  type="text" class="form-control" name="title" placeholder="Post title" required>
                    </div>
                    <div class="form-group form-outline mb-4">
                        <label for="exampleInputEmail1" class="form-label">Post image</label>
                        <div class="input-group mb-3">
                        <input style="width: 80%;" [(ngModel)]="post.image_url"  type="text" class="form-control" name="image_url" placeholder="Post image (opcional)" required>
                        <div class="input-group-append">
                            <a  class="btn btn-primary" (click)="getImagesPixabay(post.image_url)"><mat-icon class="mt-1">search</mat-icon></a>
                        </div>
                        </div>
                    </div>
                    <!-- aqui ponemos la images -->
                    <div class="row">
                        <div class="column" *ngFor="let x of ListImages">
                            <a (click)="getURL(x)"><img src="{{x}}" alt="" style="width: 100%;"></a>
                        </div>
                    </div>
                    <div class="form-group form-outline mb-4">
                        <label for="exampleInputEmail1" class="form-label">Post content</label>
                        <textarea [(ngModel)]="post.content"  type="text" class="form-control" name="content" placeholder="Post content" required></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal" >Cancel</button>
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary" type="submit">Create new post</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

 <!-- Modal Channel -->
 <div class="modal fade" id="exampleModalChannel" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel">Add New Channel</h2>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form (submit)="newChannel()" name="formRecipe" #formRecipe="ngForm">
                    <div class="form-group form-outline mb-4">
                        <label for="exampleInputEmail1" class="form-label">Channel title</label>
                        <input [(ngModel)]="addChannel.name"  type="text" class="form-control" name="name" placeholder="Channel title" required>
                    </div>    

                    <div class="form-group form-outline mb-4">
                        <label for="exampleInputEmail1" class="form-label">Channel description</label>
                        <textarea [(ngModel)]="addChannel.description" type="text" class="form-control" name="description" placeholder="Channel description" required></textarea>
                    </div>
                    
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal" >Cancel</button>
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary" type="submit" >Create new channel</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>